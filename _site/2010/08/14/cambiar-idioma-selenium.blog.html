<!DOCTYPE HTML>
<html>
<head>
  <title>Fernando Espinosa | Freelance ruby and iOS developer. Cambiar el idioma a selenium</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
  <link rel="stylesheet" type="text/css" media="screen" href="/stylesheets/ferdev.css" />
  <link rel="stylesheet" type="text/css" media="screen" href="/stylesheets/animations.css" />
  <link rel="stylesheet" type="text/css" media="screen" href="/stylesheets/glyphs.css" />
  <link rel="stylesheet" type="text/css" media="screen" href="/stylesheets/solarizeddark.css" />
  <meta name="description" content="I'm a freelance ruby and iOS developer based in Madrid, Spain. I love ruby and crafting beautiful apps with it." />
  <meta name="keywords" content="ruby, rails, ruby on rails, iOS, rubymotion, developer, freelance, freelance developer, freelance ruby, freelance rails, freelance ruby on rails, freelance iOS, freelance rubymotion, front-end, back-end, css, css3, javascript, jquery" />
  <link rel="canonical" href="http://www.ferdev.com" />
  <link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="/atom.xml" />
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/rss.xml" />
</head>
<body id="home">
  <header>
  <hgroup>

    <div class="photo">
      <div class="white_border">
      </div>
      <img src="/images/ferdev@2x.png" alt="Fernando Espinosa" width="65" height="65" />
    </div>

    <div class="name">
      <h3>fernando espinosa</h3>
      <h3>freelance ruby developer</h3>
    </div>

  </hgroup>
  <nav>
	<ul id="menu">
		<li><a href="/" title="home">home</a></li>
		<li><a href="/portfolio.html" title="portfolio">portfolio</a></li>
		<li><a href="/about-me.html" title="about me">about me</a></li>
		<li><a href="/hire-me.html" title="hiring me">hire me</a></li>
		<li><a href="/contact-me.html" title="contact">contact</a></li>
    <li class="top"><a href="#home" title="home">up</a></li>
	</ul>
</nav>

</header>

<section class="introduction">
  <div class="balloon_tail_small"></div>
  <div class="balloon_tail_medium"></div>
  <div class="balloon">
    <p class="hi"><strong>Hi!</strong></p>
    <p>
      I'm <strong>Fernando Espinosa</strong>, a <strong>developer</strong> based in Madrid, Spain.<br/>
      I <span>&#x2665;</span> <strong>ruby</strong> and crafting <strong>beautiful</strong> apps with it.
    </p>
  </div>
</section>


  <script type="text/javascript">
  var idcomments_acct = '9485e3d1ca4f30d30b14d9171a8b93b7';
  var idcomments_post_id;
  var idcomments_post_url;
</script>

<article>
  <h1>Cambiar el idioma a selenium</h1>
  

  <p>Ayer me encontré con un problema haciendo tests para un pet-project que estoy haciendo con Rails3 3.0.0.rc. Parece ser que a partir de la versión 1.0.0.beta.9 de <a href='http://github.com/carlhuda/bundler' title='Bundler'>bundler</a>, culerity lanza un error a la hora de crear el browser con celerity. Mientras investigo el problema, no quería dejar el desarrollo parado, así que decidí cambiar el driver de <a href='http://github.com/jnicklas/capybara' title='Capybara'>capybara</a> a selenium. Pero el firefox que trae el driver de selenium integrado se me ejecutaba en castellano, y yo tengo los tests escritos en inglés, por lo que fallaban. Tras twittear buscando ayuda, <a href='http://twitter.com/pacoguzman/status/21053477686' title='@pacoguzman tweet'>@pacoguzman me pasó un link</a>(gracias!) de la gente de <a href='http://teambox.com/' title='Teambox'>Teambox</a> que tenía la clave para solucionarlo.</p>

<p>Lo solución consiste en extraer el profile del driver de selenium, pasarle la nueva clave del idioma, y volver a asignar el profile al driver de selenium. La clave que había que pasar era &#8216;intl.accept_languages&#8217; (sacado de hacer un about:config en mi Firefox y buscar un poco) junto con el lenguaje que quieras usarlo, en mi caso &#8216;en&#8217;. Como yo estoy usando <a href='http://github.com/cavalle/steak' title='Steak'>Steak</a> para mis test de aceptación, incorporé el código en el archivo de configuración &#8216;spec/acceptance/acceptance_helper.rb&#8217;:</p>
<div class='highlight'><pre><code class='ruby'><span class='ss'>Capybara</span><span class='p'>:</span><span class='ss'>:Driver</span><span class='o'>::</span><span class='no'>Selenium</span><span class='o'>.</span><span class='n'>class_eval</span> <span class='k'>do</span>

  <span class='k'>class</span> <span class='o'>&lt;&lt;</span> <span class='nb'>self</span>

    <span class='k'>def</span> <span class='nf'>driver</span>

      <span class='vi'>@driver</span> <span class='o'>||=</span> <span class='k'>begin</span>
        <span class='n'>profile</span> <span class='o'>=</span> <span class='ss'>Selenium</span><span class='p'>:</span><span class='ss'>:WebDriver</span><span class='o'>::</span><span class='ss'>Firefox</span><span class='p'>:</span><span class='ss'>:Profile</span><span class='o'>.</span><span class='n'>new</span>

        <span class='n'>profile</span><span class='o'>[</span><span class='s1'>&#39;intl.accept_languages&#39;</span><span class='o'>]</span> <span class='o'>=</span> <span class='s1'>&#39;en&#39;</span>

        <span class='n'>driver</span> <span class='o'>=</span> <span class='ss'>Selenium</span><span class='p'>:</span><span class='ss'>:WebDriver</span><span class='o'>.</span><span class='n'>for</span> <span class='ss'>:firefox</span><span class='p'>,</span> <span class='ss'>:profile</span> <span class='o'>=&gt;</span> <span class='n'>profile</span>

        <span class='nb'>at_exit</span> <span class='p'>{</span> <span class='n'>driver</span><span class='o'>.</span><span class='n'>quit</span> <span class='p'>}</span>

        <span class='n'>driver</span>
      <span class='k'>end</span>

    <span class='k'>end</span>

  <span class='k'>end</span>

<span class='k'>end</span>
</code></pre></div>
<p>Y listo, selenium en inglés y todos los tests pasando!</p>

  <div class="date">
    <hr />
    <span>Aug 14, 2010</span>
    <hr />
  </div>

  <div id="comments">

    <!-- START: Livefyre Embed -->
    <div id="livefyre-comments"></div>
    <script type="text/javascript" src="http://zor.livefyre.com/wjs/v3.0/javascripts/livefyre.js"></script>
    <script type="text/javascript">
    (function () {
        var articleId = fyre.conv.load.makeArticleId(null);
        fyre.conv.load({}, [{
            el: 'livefyre-comments',
            network: "livefyre.com",
            siteId: "323683",
            articleId: articleId,
            signed: false,
            collectionMeta: {
                articleId: articleId,
                url: fyre.conv.load.makeCollectionUrl(),
            }
        }], function() {});
    }());
    </script>
    <!-- END: Livefyre Embed -->

  </div>
</article>


  <footer>
    Check the <a href="http://github.com/ferdev/ferdev">source code of this site on Github</a>.

  </footer>
  <script type="text/javascript" src="/javascripts/modernizer.js"></script>
<script type="text/javascript" src="/javascripts/ferdev.js"></script>
<script type="text/javascript" src="//use.typekit.net/jud5abl.js"></script>
<script type="text/javascript">try{Typekit.load();}catch(e){}</script>
<script type="text/javascript">
	var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
	document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
	try {
		var pageTracker = _gat._getTracker("UA-6392398-3");
		pageTracker._trackPageview();
	} catch(err) {}
</script>

</body>
</html>
